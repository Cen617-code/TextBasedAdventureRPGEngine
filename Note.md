# å­¦ä¹ ç¬”è®° - RPG å¼•æ“å¼€å‘ï¼ˆåœºæ™¯å»ºæ¨¡ï¼‰

## ğŸ“… æ—¥æœŸï¼š2026-02-13

## ğŸ¯ ä»Šæ—¥ç›®æ ‡
å®ç° `Room` ç±»çš„åŸºæœ¬æ¡†æ¶å’Œå‡ºå£ç³»ç»Ÿï¼Œä½œä¸º RPG å¼•æ“åœºæ™¯å»ºæ¨¡çš„ç¬¬ä¸€æ­¥ã€‚

---

## ğŸ“š æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. æ™ºèƒ½æŒ‡é’ˆçš„ä½¿ç”¨
- **`std::shared_ptr`**ï¼šå…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆ
- **ä½¿ç”¨åœºæ™¯**ï¼šå¤šä¸ªæˆ¿é—´å¯èƒ½éœ€è¦æŒ‡å‘åŒä¸€ä¸ªæˆ¿é—´å¯¹è±¡ï¼ˆä¾‹å¦‚æˆ¿é—´ A çš„åŒ—è¾¹æ˜¯æˆ¿é—´ Bï¼Œæˆ¿é—´ B çš„å—è¾¹åˆæ˜¯æˆ¿é—´ Aï¼‰
- **åˆ›å»ºæ–¹æ³•**ï¼š`std::make_shared<Room>(å‚æ•°...)`
- **ä¼˜ç‚¹**ï¼šè‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œé¿å…å†…å­˜æ³„æ¼

### 2. STL å®¹å™¨çš„åº”ç”¨
- **`std::map`**ï¼šé”®å€¼å¯¹æ˜ å°„å®¹å™¨
- **ä½¿ç”¨åœºæ™¯**ï¼šå­˜å‚¨æ–¹å‘å­—ç¬¦ä¸²åˆ°æˆ¿é—´æŒ‡é’ˆçš„æ˜ å°„ï¼ˆ`std::map<std::string, std::shared_ptr<Room>>`ï¼‰
- **è®¿é—®æ–¹å¼**ï¼š`map[key]` æˆ– `map.at(key)`

### 3. ç±»çš„å°è£…
- **private æˆå‘˜**ï¼šéšè—å†…éƒ¨æ•°æ®ï¼ˆname, describe, width, length, mapï¼‰
- **public æ¥å£**ï¼šé€šè¿‡ getter/setter æ–¹æ³•è®¿é—®æ•°æ®
- **æ„é€ å‡½æ•°**ï¼šåˆå§‹åŒ–å¯¹è±¡çŠ¶æ€

### 4. const æˆå‘˜æ–¹æ³•
- **ä½œç”¨**ï¼šè¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šä¿®æ”¹å¯¹è±¡çš„æˆå‘˜å˜é‡
- **ä¼˜åŠ¿**ï¼š
  - ç¼–è¯‘å™¨å¯ä»¥ä¼˜åŒ–
  - æ˜ç¡®æ¥å£è¯­ä¹‰
  - å¯ä»¥åœ¨ const å¯¹è±¡ä¸Šè°ƒç”¨

### 5. std::pair
- **ç”¨é€”**ï¼šå°†ä¸¤ä¸ªå€¼ç»„åˆæˆä¸€ä¸ªå¯¹è±¡è¿”å›
- **è®¿é—®æˆå‘˜**ï¼š`.first` å’Œ `.second`
- **åº”ç”¨**ï¼š`getSize()` è¿”å› `{length, width}`

---

## ğŸ”¨ å®ç°æ­¥éª¤

### æ­¥éª¤ 1ï¼šå®šä¹‰ Room ç±»ç»“æ„
```cpp
class Room {
private:
    std::string name;
    std::string describe;
    int width;
    int length;
    std::map<std::string, std::shared_ptr<Room>> map;
public:
    // ...
};
```

### æ­¥éª¤ 2ï¼šå®ç°æ„é€ å‡½æ•°
```cpp
Room(std::string name_, std::string describe_, int length_, int width_) {
    this->name = name_;
    this->describe = describe_;
    this->length = length_;
    this->width = width_;
}
```
**è¦ç‚¹**ï¼šä½¿ç”¨ `this->` åŒºåˆ†æˆå‘˜å˜é‡å’Œå‚æ•°

### æ­¥éª¤ 3ï¼šå®ç° setExit æ–¹æ³•ï¼ˆä»Šæ—¥æ ¸å¿ƒä»»åŠ¡ï¼‰
```cpp
void setExit(std::string direction, std::shared_ptr<Room> nextRoom) {
    map[direction] = nextRoom;
}
```
**é€»è¾‘æŒ‘æˆ˜è§£å†³**ï¼šå®‰å…¨åœ°å°†æ–¹å‘å­—ç¬¦ä¸²ä¸ç›®æ ‡æˆ¿é—´æ™ºèƒ½æŒ‡é’ˆå…³è”

### æ­¥éª¤ 4ï¼šå®ç° Getter æ–¹æ³•
```cpp
std::string getName() const { return name; }
std::string getDescribe() const { return describe; }
std::pair<int, int> getSize() const { return {length, width}; }
std::shared_ptr<Room> getExit(std::string direction) {
    return map[direction];
}
```

### æ­¥éª¤ 5ï¼šç¼–å†™æµ‹è¯•ä»£ç 
```cpp
int main() {
    auto livingRoom = std::make_shared<Room>("å®¢å…", "ä½äºä¸­å¿ƒ", 100, 100);
    auto ARoom = std::make_shared<Room>("æˆ¿é—´ A", "ä½äºå®¢å…åŒ—è¾¹", 100, 50);
    livingRoom->setExit("north", ARoom);

    // è¾“å‡ºæµ‹è¯•
    std::cout << "=== " << livingRoom->getName() << " ===" << std::endl;
    std::cout << livingRoom->getDescribe() << std::endl;
    std::cout << "å°ºå¯¸" << livingRoom->getSize().first << " * "
              << livingRoom->getSize().second << std::endl;

    // éªŒè¯å‡ºå£
    auto northRoom = livingRoom->getExit("north");
    if(northRoom) {
        std::cout << "åŒ—è¾¹å‡ºå£æŒ‡å‘" << northRoom->getName() << std::endl;
    }

    return 0;
}
```

### è¿è¡Œç»“æœ
```
=== å®¢å… ===
ä½äºä¸­å¿ƒ
å°ºå¯¸100 * 100
åŒ—è¾¹å‡ºå£æŒ‡å‘æˆ¿é—´ A
```
âœ… éªŒè¯æˆåŠŸï¼šæˆ¿é—´è¿æ¥æ­£ç¡®å·¥ä½œï¼

---

## ğŸ“ é‡è¦ä»£ç ç‰‡æ®µ

### æ™ºèƒ½æŒ‡é’ˆåˆ›å»ºå¯¹è±¡
```cpp
auto room = std::make_shared<Room>("åç§°", "æè¿°", length, width);
```

### è®¿é—®æ™ºèƒ½æŒ‡é’ˆæˆå‘˜
```cpp
room->getName();        // ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦ ->
room->setExit(...);    // ä¸æ˜¯ç‚¹è¿ç®—ç¬¦ .
```

### æ™ºèƒ½æŒ‡é’ˆçš„å¸ƒå°”åˆ¤æ–­
```cpp
if (northRoom) {    // æ£€æŸ¥æ™ºèƒ½æŒ‡é’ˆæ˜¯å¦éç©º
    // æŒ‡é’ˆæœ‰æ•ˆ
}
```

---

## ğŸ’¡ ç»éªŒæ€»ç»“

1. **ç±»è®¾è®¡è€ƒè™‘**ï¼šæˆå‘˜å˜é‡åº”è¯¥æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿï¼ˆåŸå§‹å€¼ vs æ™ºèƒ½æŒ‡é’ˆï¼‰
2. **å‘½åçº¦å®š**ï¼šå‚æ•°ç”¨åç¼€ `_` åŒºåˆ†æˆå‘˜å˜é‡å’Œå‚æ•°
3. **const æ­£ç¡®æ€§**ï¼šgetter æ–¹æ³•åº”è¯¥æ ‡è®°ä¸º const
4. **æµ‹è¯•é©±åŠ¨**ï¼šå…ˆå®ç°ç®€å•æµ‹è¯•è¾“å‡ºï¼ŒéªŒè¯é€»è¾‘æ­£ç¡®æ€§

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ·»åŠ  `getDescription()` çš„å®Œæ•´è¾“å‡ºæ ¼å¼åŒ–
- [ ] å®ç°åŒå‘æˆ¿é—´è¿æ¥ï¼ˆæˆ¿é—´ A çš„å—è¾¹å›åˆ°å®¢å…ï¼‰
- [ ] æ·»åŠ å¤šä¸ªæ–¹å‘çš„å‡ºå£æµ‹è¯•ï¼ˆeast, south, westï¼‰
- [ ] è€ƒè™‘ï¼šæ˜¯å¦éœ€è¦ `removeExit` æ–¹æ³•ï¼Ÿ
- [ ] è€ƒè™‘ï¼šæ˜¯å¦éœ€è¦ `listExits()` æ–¹æ³•æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‡ºå£ï¼Ÿ

---

## âœ… ä»Šæ—¥æˆå°±

- [âˆš] ç†è§£æ™ºèƒ½æŒ‡é’ˆçš„å…±äº«æ‰€æœ‰æƒæ¦‚å¿µ
- [âˆš] æ­£ç¡®ä½¿ç”¨ std::map å­˜å‚¨æˆ¿é—´å‡ºå£
- [âˆš] å®ç°ç±»çš„å°è£…ï¼ˆprivate/publicï¼‰
- [âˆš] ç¼–å†™å¹¶è¿è¡Œæµ‹è¯•ä»£ç éªŒè¯åŠŸèƒ½
- [âˆš] å®Œæˆ `setExit` æ ¸å¿ƒä»»åŠ¡

**é‡Œç¨‹ç¢‘**ï¼šRPG å¼•æ“çš„ç¬¬ä¸€æ­¥ - åœºæ™¯å»ºæ¨¡ - å·²å®ŒæˆåŸºç¡€æ¡†æ¶ï¼ğŸ‰

---
---

# å­¦ä¹ ç¬”è®° - RPG å¼•æ“å¼€å‘ï¼ˆäº¤äº’å¾ªç¯ä¸æ¨¡å—åŒ–ï¼‰

## ğŸ“… æ—¥æœŸï¼š2026-02-14

## ğŸ¯ ä»Šæ—¥ç›®æ ‡
å®ç°æ¸¸æˆçš„ä¸»å¾ªç¯æœºåˆ¶ï¼Œè®©ç©å®¶å¯ä»¥åœ¨æˆ¿é—´ä¹‹é—´è‡ªç”±ç§»åŠ¨ï¼Œå¹¶å¯¹ä»£ç è¿›è¡Œæ¨¡å—åŒ–é‡æ„ã€‚

---

## ğŸ“š æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. æ¨¡å—åŒ–ç¼–ç¨‹ (Modular Programming)
- **å¤´æ–‡ä»¶ (.hpp)**ï¼šæ”¾ç½®ç±»çš„å£°æ˜ï¼ˆDeclarationï¼‰ã€‚å……å½“"æ¥å£"ï¼Œå‘Šè¯‰ä½¿ç”¨è€…è¿™ä¸ªç±»æœ‰å“ªäº›åŠŸèƒ½ã€‚
  - åŒ…å«ï¼šæˆå‘˜å˜é‡å®šä¹‰ã€æ–¹æ³•åŸå‹ã€å¿…è¦çš„ `#include`ã€‚
  - é˜²å«å¼å£°æ˜ï¼š`#ifndef ROOM_HPP ... #endif` é˜²æ­¢å¤´æ–‡ä»¶è¢«é‡å¤åŒ…å«ã€‚
- **æºæ–‡ä»¶ (.cpp)**ï¼šæ”¾ç½®ç±»çš„å®ç°ï¼ˆImplementationï¼‰ã€‚
  - åŒ…å«ï¼šå…·ä½“å‡½æ•°çš„ä»£ç é€»è¾‘ã€‚
  - éœ€è¦ `#include "Room.hpp"`ã€‚
- **ä¸»ç¨‹åº (main.cpp)**ï¼šåªè´Ÿè´£ä¸šåŠ¡é€»è¾‘æµç¨‹ï¼Œä»£ç å˜å¾—éå¸¸æ•´æ´ã€‚
- **ç¼–è¯‘æ–¹æ³•**ï¼šéœ€è¦åŒæ—¶ç¼–è¯‘æ‰€æœ‰æºæ–‡ä»¶ï¼š
  ```bash
  clang++ -std=c++26 Code/main.cpp Code/Room.cpp -o rpg_engine
  ```

### 2. åŒå‘è¿æ¥ (Bidirectional Linking)
- æˆ¿é—´ä¹‹é—´çš„è¿æ¥é€šå¸¸æ˜¯åŒå‘çš„ã€‚
- **å®ç°**ï¼š
  ```cpp
  livingRoom->setExit("north", ARoom);
  ARoom->setExit("south", livingRoom); // æ‰‹åŠ¨å»ºç«‹åå‘è¿æ¥
  ```

### 3. æ¸¸æˆå¾ªç¯ (Game Loop)
- RPG æ¸¸æˆçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼š**æ˜¾ç¤ºä¿¡æ¯ -> ç­‰å¾…è¾“å…¥ -> å¤„ç†æŒ‡ä»¤ -> æ›´æ–°çŠ¶æ€**ã€‚
- **å®ç°ç»“æ„**ï¼š
  ```cpp
  while (true) {
      currentRoom->printInfo(); // 1. æ˜¾ç¤º
      std::cin >> command;      // 2. è¾“å…¥
      if (command == "quit") break; // 3. é€€å‡ºæ¡ä»¶
      // ... å¤„ç†ç§»åŠ¨ ...      // 4. æ›´æ–°çŠ¶æ€
  }
  ```

### 4. ç©å®¶çŠ¶æ€è¿½è¸ª
- ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘å½“å‰æ‰€åœ¨çš„æˆ¿é—´ã€‚
- `std::shared_ptr<Room> currentRoom = livingRoom;`
-ç§»åŠ¨å°±æ˜¯æ›´æ–°è¿™ä¸ªæŒ‡é’ˆï¼š`currentRoom = nextRoom;`

---

## ğŸ”¨ ä»£ç æ¶æ„æ¼”è¿›

### æ–‡ä»¶ç»“æ„
- `Code/Room.hpp`: Room ç±»å£°æ˜
- `Code/Room.cpp`: Room ç±»å®ç°
- `Code/main.cpp`: æ¸¸æˆå…¥å£ä¸ä¸»å¾ªç¯

### Room ç±»æ–°åŠŸèƒ½
- `printExits()`: éå† map æ‰“å°æ‰€æœ‰å¯ç”¨å‡ºå£
- `printInfo()`: å°è£…äº†åç§°ã€æè¿°å’Œå‡ºå£çš„æ‰“å°é€»è¾‘

---

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] **æŒ‡ä»¤è§£æå™¨å‡çº§**ï¼šç›®å‰åªèƒ½å¤„ç†å•è¯ï¼Œæ— æ³•å¤„ç† "go north" è¿™ç§å¸¦ç©ºæ ¼çš„æŒ‡ä»¤ã€‚
- [ ] **èƒŒåŒ…ç³»ç»Ÿ**ï¼šæ·»åŠ  `Item` ç±»ï¼Œé€šè¿‡ `pick` æŒ‡ä»¤æ¡èµ·ç‰©å“ã€‚
- [ ] **åœ°å›¾æ„å»ºå™¨**ï¼šå°†ç¡¬ç¼–ç çš„æˆ¿é—´åˆ›å»ºé€»è¾‘ï¼ˆ`make_shared`...ï¼‰ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„ `Map` ç±»æˆ–å‡½æ•°ä¸­ã€‚

---

## âœ… ä»Šæ—¥æˆå°±

- [âˆš] æˆåŠŸå°†ä»£ç æ‹†åˆ†ä¸ºæ¨¡å—åŒ–ç»“æ„ (.hpp/.cpp)
- [âˆš] å®ç°äº†åŒå‘æˆ¿é—´ç§»åŠ¨é€»è¾‘
- [âˆš] å®Œæˆäº†æ¸¸æˆä¸»å¾ªç¯ (Game Loop)
- [âˆš] ä¿®å¤äº†å•å‘ç§»åŠ¨çš„é™åˆ¶ï¼Œç°åœ¨å¯ä»¥æ¥å›èµ°åŠ¨äº†ï¼

**é‡Œç¨‹ç¢‘**ï¼šæˆ‘ä»¬çš„ RPG å¼•æ“å·²ç»â€œåŠ¨â€èµ·æ¥äº†ï¼å®ƒä¸å†æ˜¯é™æ€çš„æ•°æ®ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯äº¤äº’çš„ä¸–ç•Œã€‚ğŸŒ
